USE exercises;


DROP TABLE IF EXISTS sf_exchange_rate;

CREATE TABLE sf_exchange_rate(
source_currency varchar(50),
target_currency varchar(50),
exchange_rate float,
date datetime);


INSERT INTO sf_exchange_rate (source_currency, target_currency, exchange_rate, date) VALUES
	('USD', 'USD', '1', '2020-01-01'),
	('EUR', 'USD', '1.12', '2020-01-01'),
	('GBP', 'USD', '1.327', '2020-01-01'),
	('INR', 'USD', '0.014', '2020-01-01'),
	('AUD', 'USD', '0.702', '2020-01-01'),
	('CAD', 'USD', '0.77', '2020-01-01'),
	('CHF', 'USD', '1.03', '2020-01-01'),
	('AED', 'USD', '0.272', '2020-01-01'),
	('SEK', 'USD', '0.107', '2020-01-01'),
	('EGP', 'USD', '0.062', '2020-01-01'),
	('KWD', 'USD', '3.298', '2020-01-01'),
	('PLN', 'USD', '0.26', '2020-01-01'),
	('UAH', 'USD', '0.042', '2020-01-01'),
	('USD', 'USD', '1', '2020-02-01'),
	('EUR', 'USD', '1.109', '2020-02-01'),
	('GBP', 'USD', '1.32', '2020-02-01'),
	('INR', 'USD', '0.014', '2020-02-01'),
	('AUD', 'USD', '0.669', '2020-02-01'),
	('CAD', 'USD', '0.755', '2020-02-01'),
	('CHF', 'USD', '1.038', '2020-02-01'),
	('AED', 'USD', '0.272', '2020-02-01'),
	('SEK', 'USD', '0.104', '2020-02-01'),
	('EGP', 'USD', '0.063', '2020-02-01'),
	('KWD', 'USD', '3.292', '2020-02-01'),
	('PLN', 'USD', '0.258', '2020-02-01'),
	('UAH', 'USD', '0.04', '2020-02-01'),
	('USD', 'USD', '1', '2020-03-01'),
	('EUR', 'USD', '1.102', '2020-03-01'),
	('GBP', 'USD', '1.282', '2020-03-01'),
	('INR', 'USD', '0.014', '2020-03-01'),
	('AUD', 'USD', '0.652', '2020-03-01'),
	('CAD', 'USD', '0.746', '2020-03-01'),
	('CHF', 'USD', '1.036', '2020-03-01'),
	('AED', 'USD', '0.272', '2020-03-01'),
	('SEK', 'USD', '0.104', '2020-03-01'),
	('EGP', 'USD', '0.064', '2020-03-01'),
	('KWD', 'USD', '3.263', '2020-03-01'),
	('PLN', 'USD', '0.255', '2020-03-01'),
	('UAH', 'USD', '0.04', '2020-03-01'),
	('USD', 'USD', '1', '2020-04-01'),
	('EUR', 'USD', '1.094', '2020-04-01'),
	('GBP', 'USD', '1.24', '2020-04-01'),
	('INR', 'USD', '0.013', '2020-04-01'),
	('AUD', 'USD', '0.611', '2020-04-01'),
	('CAD', 'USD', '0.703', '2020-04-01'),
	('CHF', 'USD', '1.033', '2020-04-01'),
	('AED', 'USD', '0.272', '2020-04-01'),
	('SEK', 'USD', '0.1', '2020-04-01'),
	('EGP', 'USD', '0.063', '2020-04-01'),
	('KWD', 'USD', '3.201', '2020-04-01'),
	('PLN', 'USD', '0.238', '2020-04-01'),
	('UAH', 'USD', '0.036', '2020-04-01'),
	('USD', 'USD', '1', '2020-05-01'),
	('EUR', 'USD', '1.1', '2020-05-01'),
	('GBP', 'USD', '1.251', '2020-05-01'),
	('INR', 'USD', '0.013', '2020-05-01'),
	('AUD', 'USD', '0.642', '2020-05-01'),
	('CAD', 'USD', '0.709', '2020-05-01'),
	('CHF', 'USD', '1.042', '2020-05-01'),
	('AED', 'USD', '0.272', '2020-05-01'),
	('SEK', 'USD', '0.102', '2020-05-01'),
	('EGP', 'USD', '0.064', '2020-05-01'),
	('KWD', 'USD', '3.232', '2020-05-01'),
	('PLN', 'USD', '0.241', '2020-05-01'),
	('UAH', 'USD', '0.037', '2020-05-01'),
	('USD', 'USD', '1', '2020-06-01'),
	('EUR', 'USD', '1.112', '2020-06-01'),
	('GBP', 'USD', '1.247', '2020-06-01'),
	('INR', 'USD', '0.013', '2020-06-01'),
	('AUD', 'USD', '0.678', '2020-06-01'),
	('CAD', 'USD', '0.735', '2020-06-01'),
	('CHF', 'USD', '1.04', '2020-06-01'),
	('AED', 'USD', '0.272', '2020-06-01'),
	('SEK', 'USD', '0.107', '2020-06-01'),
	('EGP', 'USD', '0.063', '2020-06-01'),
	('KWD', 'USD', '3.245', '2020-06-01'),
	('PLN', 'USD', '0.253', '2020-06-01'),
	('UAH', 'USD', '0.037', '2020-06-01'),
	('USD', 'USD', '1', '2020-07-01'),
	('EUR', 'USD', '1.126', '2020-07-01'),
	('GBP', 'USD', '1.248', '2020-07-01'),
	('INR', 'USD', '0.013', '2020-07-01'),
	('AUD', 'USD', '0.692', '2020-07-01'),
	('CAD', 'USD', '0.736', '2020-07-01'),
	('CHF', 'USD', '1.058', '2020-07-01'),
	('AED', 'USD', '0.272', '2020-07-01'),
	('SEK', 'USD', '0.108', '2020-07-01'),
	('EGP', 'USD', '0.062', '2020-07-01'),
	('KWD', 'USD', '3.25', '2020-07-01'),
	('PLN', 'USD', '0.252', '2020-07-01'),
	('UAH', 'USD', '0.037', '2020-07-01');
    
    
    

SELECT * FROM sf_exchange_rate;



SELECT 
    source_currency,
    CAST(exchange_rate_difference AS DECIMAL(20,4)) AS "Difference of Exchange Rates"
FROM
(
SELECT 
    source_currency,
    MAX(CASE WHEN date = '2020-07-01' THEN exchange_rate END) - 
	MAX(CASE WHEN date = '2020-01-01' THEN exchange_rate END) AS exchange_rate_difference
FROM sf_exchange_rate
WHERE DATE(date) BETWEEN '2020-01-01' AND '2020-07-01'
GROUP BY source_currency) AS difference_table;